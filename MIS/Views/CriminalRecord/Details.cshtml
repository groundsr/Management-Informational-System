@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@


@using MIS.Model
@using MSI.Model
@model List<MIS.Model.CriminalRecordPoliceman>

@{CriminalRecord criminalRecord = null; }


@foreach (var item in Model)
{
    <div class="row p-5">

        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-5" style="text-align:center;">
            <h3 id="recordStatus"> Record Status : @item.CriminalRecord.Status </h3>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-5" style="text-align:center;">
            <h3 id="recordType"> Type : @item.CriminalRecord.Type </h3>
        </div>
    </div>

    <div class="ml-lg-5 mb-lg-5 col-lg-10 col-md-5 col-sm-5 border p-2 " id="descriptionArea">
        @item.CriminalRecord.Description
    </div>

    criminalRecord = @item.CriminalRecord;
    break;
}

<form asp-controller="CriminalRecord" asp-action="AddPolicemanToACriminalRecord">
    <div class="row">
        <div class="col-lg-10 col-md-5 col-sm-3 col-xs-5">
            <input type="hidden" name="criminalRecordId" value="@criminalRecord.Id" />
            <input type="text" class=" form-control-sm" name="policemanEmail" placeholder="Email.." id="emailValue" />
            <button type="submit" class="btn btn-submit btn-sm btn-primary col-2">
                Add policeman
            </button>
            <button type="button" id="myButton" class="btn btn-primary btn-sm col-2 " onclick="DisplayBlock()"> See list</button>
            <button type="button" id="myBackButton" style="display:none" class="btn btn-primary btn-sm col-2 " onclick="DisplayNone()"> Undo</button>
        </div>
    </div>

</form>

<input type="text" id="newValueType" value="@Model.ElementAt(0).CriminalRecord.Type" />
<button class="btn btn-submit" onclick="modifyType()"> Submit</button>

<a href="#editDetails"  data-toggle="modal" data-target="#editDetails">Edit Details </a>



@if (Model.ElementAt(0).Policeman != null)
{
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Name</th>
                <th scope="col">Email</th>
                <th scope="col">Seniority</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {

                <tr>
                    <td>@item.Policeman.Name</td>
                    <td>@item.Policeman.Email</td>
                    <td>@item.Policeman.Seniority</td>
                </tr>
            }
        </tbody>
    </table>

}

<div id="policemenList" style="display:none">
    @foreach (var item in Model)
    {
        <ul class="list-group">
            @if (@item.Policeman == null)
            {
                break;
            }

            else
            {
                <li class="list-group-item ml-lg-5 mr-5 p-2 " style="cursor:pointer">
                    <a id="detailsA"> <span id="mySpan">Name : @item.Policeman.Name </span></a>
                    <a><span id="mySpan">Email : @item.Policeman.Email</span></a>
                    <a><span id="mySpan">Seniority : @item.Policeman.Seniority</span></a>
                </li>
            }
        </ul>
    }

</div>

<div>
    <h4>
        Multiple File Upload
    </h4>
    <form asp-controller="CriminalRecord" asp-action="FileInModel" enctype="multipart/form-data">

        <input type="hidden" name="criminalRecordId" value="@criminalRecord.Id" />
        <input type="text" name="DocumentDTO.Name" />
        <input type="file" name="DocumentDTO.File" />
        <button type="submit"> Submit </button>
    </form>
</div>


<div class="modal fade" id="editDetails" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <form>
                    <div class="btn btn-sm">
                        <button id="enableButton" type="submit" onclick="modifyStatusEnable()" class="form-control btn-primary">Enable</button>
                    </div>

                    <div class="btn btn-sm">
                        <button id="disableButton" onclick="modifyStatusDisable()" type="submit" class="form-control btn-primary">Disable</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<div>

            @foreach (var item in ViewData["documents"] as IList<Document>)
            {
                <div>
                    <img src="@item.Path" width="200" height="200" asp-append-version="true"/>
                    <a asp-controller="CriminalRecord" asp-action="DeleteDocument" asp-route-documentId="@item.Id" asp-route-criminalRecordId="@criminalRecord.Id"> Delete </a>
                </div>
            }
    </div>


<script>


    function displayPoliceman(value) {
                document.getElementById('policemenList').style.display = value;
                console.log(value);
            }

    function DisplayBlock() {
                    displayPoliceman('block');
                    document.getElementById('myBackButton').style.display = 'block';
                    document.getElementById('myButton').style.display = 'none';

                }

    function DisplayNone() {
                    displayPoliceman('None');
                    document.getElementById('myButton').style.display = 'block';
                    document.getElementById('myBackButton').style.display = 'none';
                }


    function modifyType() {

        var myValue = document.getElementById('newValueType').value;

        $.ajax(
            {

                type: "POST",
                url: "/CriminalRecord/ModifyType?newType=" + myValue + "&criminalRecordId=" + "@Model.ElementAt(0).CriminalRecord.Id",
                success: function (response) {
                    $("#recordType").html(response);
                }
            })
    }

    function modifyStatusEnable() {
        $('#recordStatus').html("Status:Active");
            $.ajax({
                url: "/CriminalRecord/SetStatus?enumValue=1&criminalRecordId=" + "@Model.ElementAt(0).CriminalRecord.Id"
        })
    }
    function modifyStatusDisable() {
        $('#recordStatus').html("Status:Inactive");
            $.ajax({
                url: "/CriminalRecord/SetStatus?enumValue=0&criminalRecordId=" + "@Model.ElementAt(0).CriminalRecord.Id"
        })
    }



    //function setEnable(int id) {
    //                $('#enableButton')

    //                $(document).ready(function () {
    //                    var myUrl = window.location.href;
    //                    $.ajax({
    //                        type: "GET",
    //                        url: myUrl + '/GetCriminalRecordStatus/' + id,
    //                    })
    //                }
    //}

    //function enablueButton(int criminalRecord) {
    //            $('#enableButton')=
    //       }

</script>





